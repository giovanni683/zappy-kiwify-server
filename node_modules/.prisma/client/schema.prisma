generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model Account {
  id                String             @id @default(uuid())
  name              String
  status            Int
  credentials       Json
  createdAt         DateTime           @default(now())
  integrations      Integration[]
  notificationRules NotificationRule[]
}

model Integration {
  id                String             @id @default(uuid())
  accountId         String
  type              String
  credentials       Json
  account           Account            @relation(fields: [accountId], references: [id])
  notificationRules NotificationRule[]
}

model NotificationRule {
  id            String      @id @default(uuid())
  integrationId String
  accountId     String
  active        Boolean     @default(true)
  event         Int
  message       String      @db.Text
  adjustments   Json?
  variables     Json
  account       Account     @relation(fields: [accountId], references: [id])
  integration   Integration @relation(fields: [integrationId], references: [id])
  createdAt     DateTime    @default(now())
}

model NotificationLog {
  id            String   @id @default(uuid())
  accountId     String
  eventType     String
  nomeCliente   String
  numeroCliente String
  statusEnvio   String
  errorMessage  String?
  sentAt        DateTime @default(now())
}
